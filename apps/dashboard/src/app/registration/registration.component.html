<div class="registration-container">
  <div class="registration-container-content shadow-4">
    <div class="blur blur-1"></div>
    <div class="blur blur-2"></div>
    <div class="background-image"></div>
    <div class="r-4 shadow-4 login-card">
      <div class="insider-card">
        <div class="header">
          <img alt="Card" src="logo.png" />
          <div class="header-text">Register</div>
          <div class="header-text header-sub-heading">
            Let's get you set up so you can verify your personal account and
            begin your journey with us!
          </div>
        </div>
        <div class="flex flex-column form p-2 m-2 mt-6 justify-content-center">

          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <div class="grid">
              <!-- Registering For Dropdown *ngIf="false"--> 
              <div class="col-12 md:col-6" >  
                <p-floatLabel>
                  <p-dropdown [autofocus]="true" [style]="{ 'border-radius': '14px', width: '100%' }"
                    [options]="registrationOptions" formControlName="registerFor" id="registerFor">
                  </p-dropdown>
                  <label for="registerFor">You Are <span class="p-error">*</span></label>
                </p-floatLabel>
                <small class="p-error"
                  *ngIf="registerForm.get('registerFor')?.touched && registerForm.get('registerFor')?.invalid">
                  Registering For is required.
                </small>
              </div>

              <!-- Email Field -->
              <div class="col-12 md:col-6">
                <p-floatLabel>
                  <input id="email" type="email" pInputText formControlName="email"
                    style="border-radius: 14px; width: 100%" />
                  <label for="email">Email <span class="p-error">*</span></label>
                </p-floatLabel>
                <small class="p-error"
                  *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.errors?.['required']">Email is
                  required.</small>
                <small class="p-error"
                  *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.errors?.['email']">Invalid
                  email
                  format.</small>
              </div>

              <!-- Password Field -->
              <div class="col-12 md:col-6 mt-3">
                <p-floatLabel>
                  <input id="password" type="password" pInputText formControlName="password"
                    style="border-radius: 14px; width: 100%" />
                  <label for="password">Password <span class="p-error">*</span></label>
                </p-floatLabel>
                <small class="p-error"
                  *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.errors?.['required']">Password
                  is
                  required.</small>
                <small class="p-error"
                  *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.hasError('pattern')">Password
                  must
                  contain at least one uppercase letter, one number, and one special character.</small>
              </div>

              <!-- Confirm Password Field -->
              <div class="col-12 md:col-6 mt-3">
                <p-floatLabel>
                  <input id="confirmPassword" type="password" pInputText formControlName="confirmPassword"
                    style="border-radius: 14px; width: 100%" />
                  <label for="confirmPassword">Confirm Password <span class="p-error">*</span></label>
                </p-floatLabel>
                <small class="p-error"
                  *ngIf="registerForm.hasError('mismatch') && registerForm.get('confirmPassword')?.touched">
                  Passwords do not match.
                </small>
              </div>

              <!-- Parent's Name Field -->
              <div class="col-12 md:col-6 mt-3">
                <p-floatLabel>
                  <input id="parentsName" type="text" pInputText formControlName="parentsName"
                    style="border-radius: 14px; width: 100%" />
                  <label for="parentsName">Parent's Name <span class="p-error">*</span></label>
                </p-floatLabel>
                <small class="p-error"
                  *ngIf="registerForm.get('parentsName')?.hasError('required') && registerForm.get('parentsName')?.touched">Parent's
                  Name is required.</small>
              </div>

              <!-- Parent's Contact Number -->
              <div class="col-12 md:col-6 mt-3">
                <div class="flex">
                  <p-dropdown
                  formControlName="countryCode"
                  [options]="countryCodes"
                  optionLabel="label"
                  optionValue="value"
                  class="country-code-dropdown"
                  [style]="{ 'border-radius': '14px', width: '80px', height: '36px' }"
                  placeholder="Select Country Code"
                  (onChange)="onCountryChange($event)">
                </p-dropdown>
            
              <!-- <select 
              [(ngModel)]="selectedCountryCode" 
              class="form-control" 
              style="border-radius: 14px; width: 80px; height: 36px;">
              <option *ngFor="let country of countryCodes" [value]="country.code">
                {{ country.code }}
              </option>
            </select> -->
            
                
                <p-floatLabel>
                  <input id="contactNumber" type="text" class="contact" pInputText formControlName="contactNumber" maxlength="15"
                    style="border-radius: 14px;" />
                  <label for="contactNumber">Parent's Contact Number <span class="p-error">*</span></label>
                </p-floatLabel>
              </div>

                <small class="p-error"
                  *ngIf="registerForm.get('contactNumber')?.hasError('required') && registerForm.get('contactNumber')?.touched">Contact
                  Number is required.</small>
                <small class="p-error"
                  *ngIf="registerForm.get('contactNumber')?.hasError('pattern') && registerForm.get('contactNumber')?.touched">Enter
                  a valid phone number.</small>
                <small class="p-error"
                  *ngIf="registerForm.get('contactNumber')?.hasError('maxlength') && registerForm.get('contactNumber')?.touched">Number
                  cannot be more than 15 digits.</small>
             
              </div>
              <!-- Dynamic Student Fields -->
              <div formArrayName="studentDetails" class="col-12">
                <div *ngFor="let student of studentDetails.controls; let i = index" [formGroupName]="i">
                  <div class="grid">
                    <div class="col-12 md:col-6 mt-3">
                    
                      <p-floatLabel>
                        <input id="studentName" type="text" pInputText formControlName="studentName"
                          style="border-radius: 14px; width: 100%" />
                        <label for="studentName">Student Name <span class="p-error">*</span></label>
                      </p-floatLabel>
                      <small class="p-error"
                        *ngIf="student.get('studentName')?.hasError('required') && student.get('studentName')?.touched">Student
                        Name
                        is required.</small>
                      <small class="p-error"
                        *ngIf="student.get('studentName')?.hasError('minlength') && student.get('studentName')?.touched">Student
                        Name
                        must be at least 2 characters long.</small>
                    </div>
                    <!-- <div class="col-12 md:col-6 mt-3">
                      <p-floatLabel>
                        <input id="studentemail" type="email" pInputText formControlName="email"
                          style="border-radius: 14px; width: 100%" />
                        <label for="studentemail">Student Email</label>
                      </p-floatLabel>
                      <small class="p-error"
                        *ngIf="student.get('email')?.touched && student.get('email')?.errors?.['email']">Invalid email
                        format.</small>
                    </div> -->

                    <div class="col-12 md:col-6 mt-3">
                      <p-floatLabel>
                        <p-dropdown id="class" [style]="{ 'border-radius': '14px', width: '100%' }"
                          [options]="classOptions" formControlName="class" (onChange)="onClassChange($event.value, i)"

                          placeholder="Select Class"></p-dropdown>
                        <label for="class">Class <span class="p-error">*</span></label>
                      </p-floatLabel>
                      <small class="p-error"
                        *ngIf="student.get('class')?.touched && student.get('class')?.errors?.['required']">
                        Class is required.
                      </small>

                    </div>

                    <div class="col-12 md:col-6 mt-3">
                      <p-floatLabel>
                        <input id="school" [style]="{ 'border-radius': '14px', width: '100%' }" type="text" pInputText
                          formControlName="school" />
                        <label for="school">School <span class="p-error">*</span></label>
                      </p-floatLabel>
                      <small class="p-error"
                        *ngIf="student.get('school')?.touched && student.get('school')?.errors?.['required']">
                        School is required.
                      </small>

                    </div>

                    <div class="col-12 md:col-6 mt-3">
                      <p-floatLabel>
                        <p-dropdown id="ageGroup" [style]="{ 'border-radius': '14px', width: '100%' }"
                        [options]="student.get('filteredAgeGroups')?.value"
                        formControlName="ageGroup" placeholder="Select Age Group"></p-dropdown>
                        <label for="ageGroup">Age Group <span class="p-error">*</span></label>
                      </p-floatLabel>
                      <small class="p-error"
                        *ngIf="student.get('ageGroup')?.touched && student.get('ageGroup')?.errors?.['required']">
                        Age Group is required.
                      </small>

                    </div>
                    <div class="col-12 md:col-6 mt-3">
                      <p-floatLabel>
                        <p-dropdown 
                          id="howDidYouFindUs"
                          [style]="{ 'border-radius': '14px', width: '100%' }"
                          [options]="howDidYouFindUsOptions"
                          formControlName="howDidYouFindUs"
                          placeholder="Select an option">
                        </p-dropdown>
                        <label for="howDidYouFindUs">How Did You Find Us? <span class="p-error">*</span></label>
                      </p-floatLabel>
                      
                      <small class="p-error"
                        *ngIf="student.get('howDidYouFindUs')?.touched && student.get('howDidYouFindUs')?.errors?.['required']">
                        Find Us is required.
                      </small>
                    </div>
                    <div class="col-12 md:col-6 mt-3 text-end">
                      <button pButton pRipple raised="true" class="m-1" type="button"
                        *ngIf="registerForm.get('registerFor')?.value === 'Parent' && studentDetails.length > 1"
                        (click)="removeStudent(i)" icon="pi pi-user-minus" label="Remove Student"></button>
                    </div>
                  </div>
                </div>
              </div>
              <div >
              <label>
                <input type="checkbox" formControlName="agreeTerms" />
                I agree to the <a href="https://simplifyingskills.com/terms-and-conditions" target="_blank">Cookie</a> and<a href="https://simplifyingskills.com/privacy-policy" target="_blank"> Privacy Policy</a>.
              </label>

              
                <br/>

              <small class="p-error"
              *ngIf="registerForm.get('agreeTerms')?.touched && registerForm.get('agreeTerms')?.errors?.['required']">
              check term and condition.
            </small>
            </div>
          </div>
            <div class="flex justify-content-center p-1">
              <button pButton pRipple raised="true" type="button"
                *ngIf="registerForm.get('registerFor')?.value === 'Parent'" (click)="addStudent()"
                icon="pi pi-user-plus" label="Add Student" class="m-1"></button>
              <button pButton pRipple raised="true"  (click)="validationcheck()" type="submit" label="Submit" icon="pi pi-check-circle" class="m-1">
              </button>
            </div>
          </form>

        </div>

      </div>
      <div class="footer">
        <div class="footer-text">
          By signing up, you confirm that you've read
        </div>
        <div class="footer-text">
          and accepted our User Notice and Privacy Policy.
        </div>
      </div>
    </div>
  </div>
</div>
<p-toast position="top-center"></p-toast>